# Route public CDN media to internal media service container.
location /cdn/media/ {
    proxy_pass http://cdn-media-bot-v2:3010/cdn/media/;
    proxy_http_version 1.1;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;

    expires 7d;
    add_header Cache-Control "public, max-age=604800";
}

# Internal API endpoint should not be public.
location /internal/media/ {
    return 403;
}
